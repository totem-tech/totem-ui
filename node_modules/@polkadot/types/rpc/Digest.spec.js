"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _Header = _interopRequireDefault(require("../json/Header.003.json"));

var _Header0040x2e = _interopRequireDefault(require("../json/Header.004.0x2e2.json"));

var _Digest = _interopRequireWildcard(require("./Digest"));

// Copyright 2017-2019 @polkadot/types authors & contributors
// This software may be modified and distributed under the terms
// of the Apache-2.0 license. See the LICENSE file for details.
describe('Digest', () => {
  it('decodes logs with consensus', () => {
    const digest = new _Digest.default(_Header.default.result.digest);
    expect(digest.logs.length).toEqual(1);
    const log = digest.logs[0];
    expect(log.type).toBe('Consensus');
    expect(log.value.toJSON()).toEqual([1634891105, '0x69c97e0f00000000479c09f7ace12ed3e1af2dba6cca6831e257e80feef56c7474d6c69bae6f4e8a6e0045a87afe14296992c38b7d55abcbe617c441cd35e8667abbcb1678f31802']);
  });
  it('filters logs, excluding items', () => {
    const logs = new _Digest.default(_Header0040x2e.default.params.result.digest).logsWith('PreRuntime');
    expect(logs.length).toEqual(1);
    expect(logs[0].type).toEqual('PreRuntime');
  });
  it('filters logs, including items', () => {
    const logs = new _Digest.default(_Header0040x2e.default.params.result.digest).logsWithout('PreRuntime');
    expect(logs.length).toEqual(1);
    expect(logs[0].type).toEqual('Seal');
  });
  describe('ConsensusId', () => {
    it('creates a valid id for aura', () => {
      expect(_Digest.ConsensusEngineId.stringToId('afg1')).toEqual(_Digest.CID_GRPA);
      expect(_Digest.ConsensusEngineId.stringToId('aura')).toEqual(_Digest.CID_AURA);
    });
    it('reverses an id to string for babe', () => {
      expect(_Digest.ConsensusEngineId.idToString(_Digest.CID_BABE)).toEqual('babe');
    });
  });
});